{"version":3,"sources":["../../api/controllers/auth.js"],"names":["AuthController","req","res","next","token","headers","authorization","status","json","message","jwtToken","split","jwt","verify","secret","decoded","user","isCaterer","Error","caterer"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;IAEMA,c;;;;;;;;;;;;+CACyBC,G,EAAKC,G,EAAKC,I;;;;;;AAC/BC,gBAAAA,K,GAAQH,GAAG,CAACI,OAAJ,CAAYC,a;;oBACrBF,K;;;;;iDACIF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE;AAFiB,iBAArB,C;;;AAKHC,gBAAAA,Q,GAAWN,KAAK,CAACO,KAAN,CAAY,GAAZ,EAAiB,CAAjB,C;;;uBAEOC,sBAAIC,MAAJ,CAAWH,QAAX,EAAqBI,mBAArB,C;;;AAAhBC,gBAAAA,O;AACNd,gBAAAA,GAAG,CAACe,IAAJ,GAAWD,OAAO,CAACC,IAAnB;AACAb,gBAAAA,IAAI;iDACG,I;;;;;iDAEAD,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE;AAFiB,iBAArB,C;;;;;;;;;;;;;;;;;;;;;gDAOmBR,G,EAAKC,G,EAAKC,I;;;;;;AAChCC,gBAAAA,K,GAAQH,GAAG,CAACI,OAAJ,CAAYC,a;;oBACrBF,K;;;;;kDACIF,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE;AAFiB,iBAArB,C;;;AAKHC,gBAAAA,Q,GAAWN,KAAK,CAACO,KAAN,CAAY,GAAZ,EAAiB,CAAjB,C;;;uBAEOC,sBAAIC,MAAJ,CAAWH,QAAX,EAAqBI,mBAArB,C;;;AAAhBC,gBAAAA,O;;oBACDA,OAAO,CAACE,S;;;;;sBACL,IAAIC,KAAJ,CAAU,cAAV,C;;;AAERjB,gBAAAA,GAAG,CAACkB,OAAJ,GAAcJ,OAAO,CAACI,OAAtB;AACAhB,gBAAAA,IAAI;kDACG,I;;;;;kDAEAD,GAAG,CAACK,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE;AAFiB,iBAArB,C;;;;;;;;;;;;;;;;;;;;;eAQET,c","sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport secret from '../util/jwt_secret';\r\n\r\nclass AuthController {\r\n  static async verifyUserToken(req, res, next) {\r\n    const token = req.headers.authorization;\r\n    if (!token) {\r\n      return res.status(401).json({\r\n        status: 'error',\r\n        message: 'No Token Provided'\r\n      });\r\n    }\r\n    const jwtToken = token.split(' ')[1];\r\n    try {\r\n      const decoded = await jwt.verify(jwtToken, secret);\r\n      req.user = decoded.user;\r\n      next();\r\n      return true;\r\n    } catch (err) {\r\n      return res.status(401).json({\r\n        status: 'error',\r\n        message: 'Invalid Auth Token'\r\n      });\r\n    }\r\n  }\r\n\r\n  static async verifyAdminToken(req, res, next) {\r\n    const token = req.headers.authorization;\r\n    if (!token) {\r\n      return res.status(401).json({\r\n        status: 'error',\r\n        message: 'No Token Provided'\r\n      });\r\n    }\r\n    const jwtToken = token.split(' ')[1];\r\n    try {\r\n      const decoded = await jwt.verify(jwtToken, secret);\r\n      if (!decoded.isCaterer) {\r\n        throw new Error('Unauthorized');\r\n      }\r\n      req.caterer = decoded.caterer;\r\n      next();\r\n      return true;\r\n    } catch (err) {\r\n      return res.status(401).json({\r\n        status: 'error',\r\n        message: 'Unauthorized'\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\nexport default AuthController;\r\n"],"file":"auth.js"}