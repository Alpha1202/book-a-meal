{"version":3,"sources":["../../api/middleware/meals.js"],"names":["MealMiddleware","req","res","next","schema","name","Joi","string","required","price","number","min","validate","body","files","Error","imageMimes","includes","image","mimetype","status","json","message","details","undefined","type","mealId","quantity"],"mappings":";;;;;;;AAAA;;;;;;;;;;;;;;IAEMA,c;;;;;;;;;;;;+CACyBC,G,EAAKC,G,EAAKC,I;;;;;;;AAE7BC,gBAAAA,M,GAAS;AACbC,kBAAAA,IAAI,EAAEC,aAAIC,MAAJ,GAAaC,QAAb,EADO;AAEbC,kBAAAA,KAAK,EAAEH,aAAII,MAAJ,GACJC,GADI,CACA,CADA,EAEJH,QAFI;AAFM,iB;;uBAMTF,aAAIM,QAAJ,CAAaX,GAAG,CAACY,IAAjB,EAAuBT,MAAvB,C;;;sBACFH,GAAG,CAACa,KAAJ,KAAc,I;;;;;sBACV,IAAIC,KAAJ,CAAU,qBAAV,C;;;AAEFC,gBAAAA,U,GAAa,CAAC,YAAD,EAAe,WAAf,EAA4B,WAA5B,C;;oBACdA,UAAU,CAACC,QAAX,CAAoBhB,GAAG,CAACa,KAAJ,CAAUI,KAAV,CAAgBC,QAApC,C;;;;;sBACG,IAAIJ,KAAJ,CAAU,yCAAV,C;;;AAERZ,gBAAAA,IAAI;;;;;;;iDAEGD,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE,YAAIC,OAAJ,KAAgBC,SAAhB,GAA4B,YAAID,OAAJ,CAAY,CAAZ,EAAeD,OAA3C,GAAqD,YAAIA,OAFxC;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;iDAMF,I;;;;;;;;;;;;;;;;;;;;;gDAGuBxB,G,EAAKC,G,EAAKC,I;;;;;;;AAEhCC,gBAAAA,M,GAAS;AACbC,kBAAAA,IAAI,EAAEC,aAAIC,MAAJ,EADO;AAEbE,kBAAAA,KAAK,EAAEH,aAAII,MAAJ,GAAaC,GAAb,CAAiB,CAAjB;AAFM,iB;;uBAITL,aAAIM,QAAJ,CAAaX,GAAG,CAACY,IAAjB,EAAuBT,MAAvB,C;;;sBACFH,GAAG,CAACa,KAAJ,KAAc,I;;;;;AACVE,gBAAAA,U,GAAa,CAAC,YAAD,EAAe,WAAf,EAA4B,WAA5B,C;;oBACdA,UAAU,CAACC,QAAX,CAAoBhB,GAAG,CAACa,KAAJ,CAAUI,KAAV,CAAgBC,QAApC,C;;;;;sBACG,IAAIJ,KAAJ,CAAU,yCAAV,C;;;AAGVZ,gBAAAA,IAAI;;;;;;;kDAEGD,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE,aAAIC,OAAJ,KAAgBC,SAAhB,GAA4B,aAAID,OAAJ,CAAY,CAAZ,EAAeD,OAA3C,GAAqD,aAAIA,OAFxC;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;kDAMF,I;;;;;;;;;;;;;;;;;;;;;gDAG0BxB,G,EAAKC,G,EAAKC,I;;;;;;;AAEnCC,gBAAAA,M,GAAS;AACbsB,kBAAAA,MAAM,EAAEpB,aAAII,MAAJ,GAAaF,QAAb,EADK;AAEbmB,kBAAAA,QAAQ,EAAErB,aAAII,MAAJ,GACPC,GADO,CACH,CADG,EAEPH,QAFO;AAFG,iB;;uBAMTF,aAAIM,QAAJ,CAAaX,GAAG,CAACY,IAAjB,EAAuBT,MAAvB,C;;;AACND,gBAAAA,IAAI;;;;;;;kDAEGD,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAC1BD,kBAAAA,MAAM,EAAE,OADkB;AAE1BE,kBAAAA,OAAO,EAAE,aAAIC,OAAJ,CAAY,CAAZ,EAAeD,OAFE;AAG1BG,kBAAAA,IAAI,EAAE;AAHoB,iBAArB,C;;;kDAMF,I;;;;;;;;;;;;;;;;;;;;;eAIIzB,c","sourcesContent":["import Joi from 'joi';\r\n\r\nclass MealMiddleware {\r\n  static async validateAddMeal(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        name: Joi.string().required(),\r\n        price: Joi.number()\r\n          .min(1)\r\n          .required()\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      if (req.files === null) {\r\n        throw new Error('Meal Image Required');\r\n      }\r\n      const imageMimes = ['image/jpeg', 'image/jpg', 'image/png'];\r\n      if (!imageMimes.includes(req.files.image.mimetype)) {\r\n        throw new Error('Only JPG, JPEG & PNG Images are allowed');\r\n      }\r\n      next();\r\n    } catch (err) {\r\n      return res.status(400).json({\r\n        status: 'error',\r\n        message: err.details !== undefined ? err.details[0].message : err.message,\r\n        type: 'validation'\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n\r\n  static async validateUpdateMeal(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        name: Joi.string(),\r\n        price: Joi.number().min(1)\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      if (req.files !== null) {\r\n        const imageMimes = ['image/jpeg', 'image/jpg', 'image/png'];\r\n        if (!imageMimes.includes(req.files.image.mimetype)) {\r\n          throw new Error('Only JPG, JPEG & PNG Images are allowed');\r\n        }\r\n      }\r\n      next();\r\n    } catch (err) {\r\n      return res.status(400).json({\r\n        status: 'error',\r\n        message: err.details !== undefined ? err.details[0].message : err.message,\r\n        type: 'validation'\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n\r\n  static async validateAddMealToMenu(req, res, next) {\r\n    try {\r\n      const schema = {\r\n        mealId: Joi.number().required(),\r\n        quantity: Joi.number()\r\n          .min(1)\r\n          .required()\r\n      };\r\n      await Joi.validate(req.body, schema);\r\n      next();\r\n    } catch (err) {\r\n      return res.status(400).json({\r\n        status: 'error',\r\n        message: err.details[0].message,\r\n        type: 'validation'\r\n      });\r\n    }\r\n    return true;\r\n  }\r\n}\r\n\r\nexport default MealMiddleware;\r\n"],"file":"meals.js"}